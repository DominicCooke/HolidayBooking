infoBoxDirective=function(){return{restrict:"E",templateUrl:"/Scripts/app/templates/employee/employeeCalendarInfoBoxTemplate.html",controller:"calendarCtrl",scope:!0,link:function(n){n.$watch("userHolidayBookings",function(){var r=0,u=0,f=0,i,t;if(typeof n.userHolidayBookings!="undefined"){for(i=n.userHolidayBookings.HolidayBookings,t=0;t<i.length;t++)i[t].BookingStatus==0?r++:i[t].BookingStatus==1?u++:f++;n.infoBoxDays={Pending:r,Confirmed:u,Cancelled:f,Remaining:n.userHolidayBookings.RemainingAllowance,Name:n.userHolidayBookings.FirstName+" "+n.userHolidayBookings.LastName}}},!0)}}};tabsDirective=function(){return{restrict:"E",templateUrl:"/Scripts/app/templates/manager/managerCalendarTabsTemplate.html",controller:"calendarCtrl",scope:!0,link:function(){}}};tooltipDirective=function(n){return{restrict:"E",templateUrl:function(t,i){return n[i.mode]},controller:"calendarCtrl",scope:!1,link:function(n){function t(t){for(var h,r,i,u,f=[],o=0,s=0,e=0;e<n.listOfTeamMembers.length;e++)h={name:n.listOfTeamMembers[e],isFoundState:"crossed"},f.push(h);for(r=n.teamUserHolidayBookings,i=0;i<r.length;i++)for(u=0;u<r[i].HolidayBookings.length;u++)r[i].HolidayBookings[u].StartDate.isSame(t,"day")&&(o++,r[i].HolidayBookings[u].BookingStatus=="0"?f[i].isFoundState="pending":r[i].HolidayBookings[u].BookingStatus=="1"?(f[i].isFoundState="checked",s++):f[i].isFoundState="cancelled");return{allCount:o,names:f,confirmedCount:s}}n.checkIsFound=function(t){n.isFoundValue=null;t=="checked"?n.isFoundValue="checked":t=="pending"?n.isFoundValue="pending":t=="cancelled"&&(n.isFoundValue="cancelled")};n.getHolidayAmount=function(t){n.HolidayAmount=t};n.showTooltip=function(i,r){if(countAndNamesOfEmployeesWithHolidayOnDate=t(r.date),r.isTeamHoliday==!1||countAndNamesOfEmployeesWithHolidayOnDate.allCount==0){n.tooltipIsVisible=!1;return}n.tooltipIsVisible=!0;var f=i.clientX+40+"px",e=i.clientY+"px",u=$(".hoverTooltip")[0];u.style.left=f;u.style.top=e;n.holidayConfirmCountTooltip=countAndNamesOfEmployeesWithHolidayOnDate.confirmedCount;n.holidayCountTooltip=countAndNamesOfEmployeesWithHolidayOnDate.allCount;n.holidayEmployeeNamesTooltip=countAndNamesOfEmployeesWithHolidayOnDate.names};n.moveTooltip=function(n){var i=n.clientX+40+"px",r=n.clientY+"px",t=$(".hoverTooltip")[0];t.style.left=i;t.style.top=r};n.hideTooltip=function(){n.tooltipIsVisible=!1}}}};calendarDirective=function(n,t,i){return{restrict:"E",templateUrl:function(t,i){return n[i.mode]},controller:"calendarCtrl",scope:!1,link:function(n){function e(n){var t=n.day();return t==6||t==0?!0:!1}function o(t){for(var u,e,f=0,r=n.teamUserHolidayBookings,i=0;i<r.length;i++)if(r[i].isVisible==!0)for(u=0;u<r[i].HolidayBookings.length;u++)if(e=r[i].HolidayBookings[u],e.StartDate.isSame(t,"day")&&e.BookingStatus==1){f++;break}if(f>0)return f}function r(t,i){var f=!1,u,r;if(n.userHolidayBookings.isVisible==!0)for(u=n.userHolidayBookings.HolidayBookings,r=0;r<u.length;r++)if(u[r].StartDate.isSame(t,"day")&&u[r].BookingStatus==i){f=!0;break}return f}function s(t){for(var i,r=0;r<n.publicHolidays.days.length;r++)if(n.publicHolidays.days[r].isSame(t,"day")){i=!0;break}else i=!1;return i}function h(t,i){for(var f,e,u=n.teamUserHolidayBookings,r=0;r<u.length;r++)if(u[r].isVisible==!0)for(f=0;f<u[r].HolidayBookings.length;f++)if(e=u[r].HolidayBookings[f],e.StartDate.isSame(t,"day")&&e.BookingStatus==i)return!0;return!1}function u(n){return n.day(1).hour(0).minute(0).second(0).millisecond(0)}function f(n,t,i){n.weeks=[];for(var u=!1,r=t.clone(),f=r.month(),e=0;!u;)n.weeks.push({days:c(n,r.clone(),i)}),r.add(1,"w"),u=e++>2&&f!==r.month(),f=r.month()}function c(n,t,i){for(var u=[],f=0;f<7;f++)n.mode=="manager"?u.push({name:t.format("dd").substring(0,1),number:t.date(),isCurrentMonth:t.month()===i.month(),isToday:t.isSame(new Date,"day"),isPublicHoliday:s(t),isWeekend:e(t),date:t,isPendingHoliday:h(t,0),isCancelledHoliday:h(t,2),holidayCount:o(t)}):u.push({name:t.format("dd").substring(0,1),number:t.date(),isCurrentMonth:t.month()===i.month(),isToday:t.isSame(new Date,"day"),isPublicHoliday:s(t),isWeekend:e(t),date:t,isConfirmedHoliday:r(t,1),isCancelledHoliday:r(t,2),isPendingHoliday:r(t,0),holidayCount:o(t)}),t=t.clone(),t.add(1,"d");return u}function l(){n.mode=="employee"&&(n.userHolidayBookings=i.getUser(),n.initData([n.userHolidayBookings]),n.userHolidayBookings.isVisible=!n.userHolidayBookings.isVisible);n.reloadCalendar()}n.select=function(t){var f,i,u,e,o;if(n.selected=t,n.editMode==!0){if((r(t,0)==!0||r(t,1)==!0||r(t,2)==!0)&&(f=!0),i=n.userHolidayBookings.HolidayBookings,f==!0)for(u=0;u<i.length;u++)i[u].StartDate.isSame(t,"day")&&(i[u].BookingStatus==0?(i.splice(u,1),n.userHolidayBookings.RemainingAllowance++):i[u].BookingStatus==1?i[u].BookingStatus=2:i[u].BookingStatus==2&&(i[u].BookingStatus=1));else n.userHolidayBookings.RemainingAllowance--,e=t.clone().add(1,"h"),o=t.clone().add(1,"h"),i.push({StartDate:e,EndDate:o,AllowanceDays:1,BookingStatus:0,HolidayId:0});n.reloadCalendar(!0);n.teamHolidayCount()}};n.next=function(){var t=n.month.clone();u(t.month(t.month()+1).date(0));n.month.month(n.month.month()+1);f(n,t,n.month);n.selected=n.month.clone();n.teamHolidayCount()};n.previous=function(){var t=n.month.clone();u(t.month(t.month()-1).date(0));n.month.month(n.month.month()-1);f(n,t,n.month);n.selected=n.month.clone();n.teamHolidayCount()};n.teamHolidayCount=function(){t(function(){$(".day").each(function(){for(var t=$(this)[0].getAttribute("amountofholiday"),i=!1,n=0;n<=t;n++)if(className=$(this).hasClass("employeeCalendar")?"teamHolidayEmployee"+n:"teamHoliday"+n,$(this).hasClass(className)){i=!0;$(this).children(".confirmedHolidayCount").text(t);$(this).children(".confirmedHolidayCount").css("display")=="none"&&$(this).children(".confirmedHolidayCount").fadeIn("slow");break}})})};n.reloadCalendar=function(t){var i;t==!0?i=n.month.clone():(n.month=n.selected.clone(),i=n.selected.clone());i.date(-3);u(i.day(0));f(n,u(i.endOf("month")),n.month)};l()}}};calendarControlsDirective=function(n,t){return{restrict:"E",templateUrl:function(n,i){return t[i.mode]},controller:"calendarCtrl",scope:!1,link:function(n){function i(i,r){var o=!1,s=$(".teamMember"),f=n.teamUserHolidayBookings,e,u;if(i=="all"){for(r.target.classList.contains("active")&&(o=!0),e=0;e<s.length;e++)t(s[e],"dead");for(u=0;u<f.length;u++)f[u].isVisible=o}else for(u=0;u<f.length;u++)f[u].StaffId==i&&(f[u].isVisible=!f[u].isVisible)}function t(n,t){n.classList.contains(t)?(n.classList.remove(t),n.classList.remove("active")):n.classList.add(t)}n.$watch("tabHolidays",function(){n.mode=="manager"&&(typeof n.tabHolidays!="undefined"?($(".tabTableHeaderRow").removeClass("hidden"),n.tabHolidays.TabHolidays.length==0?$(".tabTableHeaderRow").addClass("hidden"):n.tabHolidays.TypeOfHoliday==0?$(".pendingHolidayRow").show():n.tabHolidays.TypeOfHoliday==2&&$(".cancelledHolidayRow").show()):$(".tabTableHeaderRow").addClass("hidden"))},!0);n.$watch("teamUserHolidayBookings",function(){var t;if(n.mode=="manager"&&typeof n.teamUserHolidayBookings!="undefined"){var u=n.teamUserHolidayBookings,i=0,r=0;for(t=0;t<u.length;t++)i=i+u[t].PendingHolidays,r=r+u[t].CancelledHolidays;n.pendingNotificationCount=i;n.cancelledNotificationCount=r;i==0?$(".notification-counter-pending").hide():$(".notification-counter-pending").show();r==0?$(".notification-counter-cancelled").hide():$(".notification-counter-cancelled").show()}},!0);n.isChecked=function(r){var u=r.target.getAttribute("value");t(r.target,"active");i(u,r);n.reloadCalendar();n.teamHolidayCount()};n.populateTableCounts=function(n){for(var r=0,u=0,f=0,i=n.HolidayBookings,t=0;t<i.length;t++)i[t].BookingStatus==0?r++:i[t].BookingStatus==1?u++:f++;n.PendingHolidays=r;n.ConfirmedHolidays=u;n.CancelledHolidays=f};n.addScrollBar=function(){jQuery(".subTableBody").scrollbar();jQuery(".subTabTableBody").scrollbar()};n.formatDate=function(n){var t=n.toObject(),i=moment(t);return i.format("dddd, MMMM Do YYYY")};n.tabHolidayAction=function(t,i,r,u){for(var o,h,s,e=n.teamUserHolidayBookings,f=0;f<e.length;f++)if(e[f].StaffId==i)for(o=0;o<e[f].HolidayBookings.length;o++)if(e[f].HolidayBookings[o].StartDate.isSame(t,"day")&&e[f].StaffId==i){for(h=n.tabHolidays,s=0;s<h.TabHolidays.length;s++)h.TabHolidays[s].StaffId==e[f].StaffId&&h.TabHolidays[s].HolidayDate==e[f].HolidayBookings[o]&&h.TabHolidays.splice(s,1);u=="accept"?e[f].HolidayBookings[o].BookingStatus==0?e[f].HolidayBookings[o].BookingStatus=1:(e[f].HolidayBookings.splice(o,1),e[f].RemainingAllowance++):e[f].HolidayBookings[o].BookingStatus==0?(e[f].HolidayBookings.splice(o,1),e[f].RemainingAllowance++):e[f].HolidayBookings[o].BookingStatus=1}n.reloadCalendar();n.teamHolidayCount()};n.tabHolidaySelect=function(t,i){for(var f,u=n.teamUserHolidayBookings,e=[],r=0;r<u.length;r++)if(u[r].HolidayBookings=_.sortBy(u[r].HolidayBookings,function(n){return n.StartDate}),u[r].StaffId==t)for(f=0;f<u[r].HolidayBookings.length;f++)u[r].HolidayBookings[f].BookingStatus==i&&e.push({StaffId:t,HolidayDate:u[r].HolidayBookings[f],TypeOfHoliday:i});n.tabHolidays={TabHolidays:e,TypeOfHoliday:i}}}}};calendarControlsDirective.$inject=["dataService","templates"];
//# sourceMappingURL=directives.min.js.map
